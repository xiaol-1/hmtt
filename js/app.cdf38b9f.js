(function(){"use strict";var t={668:function(t,e,n){var s=n(6369),i=function(){var t=this,e=t._self._c;return e("div",[e("keep-alive",{attrs:{include:"MyLayout"}},[e("router-view")],1)],1)},a=[],o={},r=o,l=n(1001),c=(0,l.Z)(r,i,a,!1,null,null,null),u=c.exports,h=(n(6743),n(8848)),d=n(2631),f=function(){var t=this,e=t._self._c;return e("div",[e("keep-alive",{attrs:{include:"MyHome"}},[e("router-view")],1),e("van-tabbar",{attrs:{route:"",placeholder:""}},[e("van-tabbar-item",{attrs:{to:"/layout/home",icon:"home-o"}},[t._v("首页")]),e("van-tabbar-item",{attrs:{to:"/layout/ask",icon:"chat-o"}},[t._v("问答")]),e("van-tabbar-item",{attrs:{to:"/layout/video",icon:"video-o"}},[t._v("视频")]),e("van-tabbar-item",{attrs:{to:"/layout/mine",icon:"friends-o"}},[t._v("我的")])],1)],1)},v=[],p={name:"MyLayout",data(){return{}}},m=p,_=(0,l.Z)(m,f,v,!1,null,null,null),y=_.exports,g=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{title:"登录"}}),e("van-form",{on:{submit:t.onSubmit}},[e("van-field",{attrs:{name:"手机号",label:"手机号",placeholder:"手机号",rules:t.rule.mobile},model:{value:t.info.mobile,callback:function(e){t.$set(t.info,"mobile",e)},expression:"info.mobile"}}),e("van-field",{attrs:{name:"验证码",label:"验证码",placeholder:"验证码",rules:t.rule.code},model:{value:t.info.code,callback:function(e){t.$set(t.info,"code",e)},expression:"info.code"}}),e("div",{staticStyle:{margin:"16px"}},[e("van-button",{attrs:{loading:t.isload,"loading-text":"登录中",round:"",block:"",type:"info","native-type":"submit"}},[t._v("登录")])],1)],1)],1)},k=[],w=(n(7658),n(4161)),b=n(3822),C=n(2415),Z={namespaced:!0,state(){return{token:{},userInfo:{}}},mutations:{Settoken(t,e){t.token=e},Deltoken(t){t.token={}},SetInfo(t,e){t.userInfo=e}},actions:{async requestInfo(t){if(!t.state.userInfo.id){const e=await I();t.commit("SetInfo",e.data)}}}};s.ZP.use(b.ZP);var x=new b.ZP.Store({modules:{user:Z},plugins:[(0,C.Z)({key:"token",paths:["user.token"]})]});const $=w.Z.create({baseURL:"http://geek.itheima.net/"});$.interceptors.response.use((function(t){return t.data}),(async function(t){if(401!==t.response.status)return Promise.reject(t);try{const e=await(0,w.Z)({url:"http://geek.itheima.net/v1_0/authorizations",method:"put",headers:{Authorization:`Bearer ${x.state.user.token.refresh_token}`}});return x.commit("user/Settoken",{token:e.data.data.token,refresh_token:x.state.user.token.refresh_token}),$(t.config)}catch{return(0,h.Z)("登录状态失效,请重新登录"),ke.push("/login"),{}}})),$.interceptors.request.use((function(t){const e=JSON.parse(localStorage.getItem("token"));return e&&(t.headers.Authorization=`Bearer ${e.user.token.token}`),t}),(function(t){return Promise.reject(t)}));var S=$;function P(t){return S({url:"/v1_0/authorizations",method:"post",data:t})}function I(){return S({url:"/v1_0/user/profile"})}function L(t){return S({url:"/v1_0/user/photo",method:"patch",data:t})}function M(t){return S({url:"/v1_0/user/profile",method:"patch",data:t})}const O=t=>S({url:"/v1_0/user/followings",method:"post",data:t}),q=t=>S({url:`/v1_0/user/followings/${t}`,method:"delete"});var D={name:"MyLogin",data(){return{info:{mobile:"",code:""},rule:{mobile:[{required:!0,message:"请输入手机号"},{pattern:/^1[2-9]\d{9}$/,message:"请输入正确的手机号"}],code:[{required:!0,message:"请输入验证码"},{pattern:/^\d{6}$/,message:"请输入正确的数字验证码"}]},isload:!1}},methods:{async onSubmit(){try{this.isload=!0;const t=await P(this.info);this.$store.commit("user/Settoken",t.data),this.$route.query.back?this.$router.push(this.$route.query.back):this.$router.push("/layout/home"),this.$toast.success("登录成功")}catch(t){this.$toast.fail(`${t.response.data.message}`)}finally{this.isload=!1}}}},A=D,E=(0,l.Z)(A,g,k,!1,null,"849dd1d4",null),z=E.exports,N=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"top"},[e("van-nav-bar",{attrs:{title:"","left-text":"返回",placeholder:""},scopedSlots:t._u([{key:"left",fn:function(){return[e("div",{staticClass:"logo"})]},proxy:!0},{key:"right",fn:function(){return[e("van-button",{attrs:{round:"",size:"small",type:"info",to:"/search"}},[e("van-icon",{attrs:{color:"#fff",size:"15px",name:"search"}}),t._v("搜索 ")],1)]},proxy:!0}])})],1),e("div",{staticClass:"wrap"},[e("van-tabs",{model:{value:t.selected,callback:function(e){t.selected=e},expression:"selected"}},t._l(t.channels,(function(n){return e("van-tab",{key:n.id,attrs:{title:n.name,name:n.id}},[e("MyArticle",{attrs:{id:n.id}}),e("van-action-sheet",{attrs:{title:"频道管理"},model:{value:t.ChennelShow,callback:function(e){t.ChennelShow=e},expression:"ChennelShow"}},[e("div",{staticClass:"content"},[e("div",{staticClass:"top"},[e("div",{staticClass:"title"},[e("span",[t._v("我的频道")]),e("van-button",{attrs:{plain:"",size:"mini",color:"#f00"},on:{click:function(e){t.iconShow=!t.iconShow}}},[t._v(t._s(t.iconShow?"取消":"编辑"))])],1),e("van-grid",{attrs:{"column-num":4}},t._l(t.channels,(function(n){return e("van-grid-item",{key:n.id,on:{click:function(e){return t.onClick(n.id)}}},[e("span",{staticClass:"item",class:t.selected===n.id?"active":""},[t._v(t._s(n.name))]),e("van-icon",{directives:[{name:"show",rawName:"v-show",value:t.iconShow&&0!==n.id,expression:"iconShow && item.id!==0"}],attrs:{name:"cross"},on:{click:function(e){return t.iconEdit(n.id)}}})],1)})),1)],1),e("div",{staticClass:"foot"},[e("div",{staticClass:"title"},[e("span",[t._v("可选频道")])]),e("van-grid",{attrs:{"column-num":4}},t._l(t.ChannelAll,(function(n){return e("van-grid-item",{key:n.id,on:{click:function(e){return t.Edit(n.id)}}},[e("span",{staticClass:"item"},[t._v(t._s(n.name))])])})),1)],1)])])],1)})),1),e("van-icon",{staticClass:"open-icon",attrs:{name:"wap-nav"},on:{click:function(e){t.ChennelShow=!0}}})],1)])},T=[];function j(){return S({url:"/v1_0/user/channels"})}function H(){return S({url:"/v1_0/channels"})}function Y(t){return S({url:"/v1_0/user/channels",method:"put",data:t})}var B=function(){var t=this,e=t._self._c;return e("div",{ref:"list",staticClass:"article",on:{scroll:t.onScroll}},[e("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(n){return e("van-cell",{key:n.art_id,on:{click:function(e){return t.skip(n.art_id)}},scopedSlots:t._u([{key:"default",fn:function(){return[e("div",{staticClass:"title"},[t._v(t._s(n.title))]),e("div",[e("van-grid",{attrs:{border:!1,"column-num":n.cover.type}},t._l(n.cover.images,(function(t,n){return e("van-grid-item",{key:n},[e("van-image",{attrs:{src:t}})],1)})),1)],1),e("div",{staticClass:"authorbox"},[e("span",[t._v(t._s(n.aut_name))]),e("span",{staticClass:"comment"},[t._v(t._s(n.comm_count)+"评论")]),e("span",[t._v(t._s(t.$format(n.pubdate)))]),e("van-icon",{staticStyle:{float:"right"},attrs:{name:"cross"}})],1)]},proxy:!0}],null,!0)})})),1)],1)],1)},J=[];function R(t){return S({url:"/v1_0/articles",params:t})}function F(t){return S({url:`/v1_0/articles/${t}`})}function V(t){return S({url:"/v1_0/comment/likings",method:"post",data:t})}function U(t){return S({url:`/v1_0/comment/likings/${t}`,method:"DELETE"})}var W={name:"MyArticle",data(){return{list:[],loading:!1,finished:!1,refreshing:!1,pre_timestamp:new Date,scrollH:0}},props:{id:{required:!0}},activated(){this.$refs.list.scrollTop=this.scrollH},methods:{onScroll(){this.scrollH=this.$refs.list.scrollTop},async onLoad(){const t=await R({channel_id:this.id,timestamp:this.pre_timestamp});this.pre_timestamp=t.data.pre_timestamp,this.list.push(...t.data.results),this.refreshing&&(this.list=[],this.refreshing=!1),this.loading=!1,null===this.pre_timestamp&&(this.finished=!0)},async onRefresh(){this.finished=!1;const t=await R({channel_id:this.id,timestamp:new Date});this.list=t.data.results,this.pre_timestamp=t.data.pre_timestamp,this.refreshing=!1,this.loading=!1},skip(t){this.$router.push({path:"/news",query:{id:t}})}}},G=W,K=(0,l.Z)(G,B,J,!1,null,"15b1d2ac",null),Q=K.exports,X={name:"MyHome",components:{MyArticle:Q},data(){return{channels:[],ChennelShow:!1,iconShow:!1,ChannelAll:[],EditChannel:[],selected:0}},methods:{onClick(t){this.selected=t,this.active=t,this.ChennelShow=!1},async iconEdit(t){const e=this.channels.find((e=>e.id===t));this.ChannelAll.push(e),this.selected===t&&(this.channels[this.channels.indexOf(e)+1]?this.selected=this.channels[this.channels.indexOf(e)+1].id:this.selected=0),this.channels.splice(this.channels.indexOf(e),1),this.EditChannel=this.EditChannel.filter((e=>e.id!==t))},async Edit(t){const e=this.ChannelAll.find((e=>e.id===t));this.channels.push(e),this.ChannelAll.splice(this.ChannelAll.indexOf(e),1),this.EditChannel.push({id:t,seq:t})}},async created(){const t=JSON.parse(localStorage.getItem("channels-97"));if(this.$store.state.user.token.token||!t){const t=await j();this.channels=t.data.channels}else this.channels=t;const e=await H();this.ChannelAll=e.data.channels;for(let n=0;n<this.channels.length;n++)this.ChannelAll=this.ChannelAll.filter((t=>t.id!==this.channels[n].id));this.channels.forEach((t=>{this.EditChannel.push({id:t.id,seq:t.id})}))},watch:{async channels(){this.$store.state.user.token.token&&this.EditChannel[1]?await Y({channels:this.EditChannel}):localStorage.setItem("channels-97",JSON.stringify(this.channels))}}},tt=X,et=(0,l.Z)(tt,N,T,!1,null,"09a377fa",null),nt=et.exports,st=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"top"},[e("van-image",{attrs:{round:"",fit:"cover",src:t.userinfo.photo}}),e("div",{staticClass:"title"},[e("h2",[t._v(t._s(t.userinfo.name))]),e("div",{staticClass:"year"},[e("span",[t._v(t._s(t.userinfo.birthday))])])])],1),e("div",{staticClass:"middle"},[e("div",[e("van-icon",{attrs:{name:"newspaper-o",color:"#3296fa"}}),e("span",[t._v("我的作品")])],1),e("div",[e("van-icon",{attrs:{name:"star-o",color:"#ff0000"}}),e("span",[t._v("我的搜藏")])],1),e("div",[e("van-icon",{attrs:{name:"tosend",color:"#ffa500"}}),e("span",[t._v("阅读历史")])],1)]),e("div",{staticClass:"foot"},[e("van-cell-group",[e("van-cell",{attrs:{icon:"edit",title:"编辑资料","is-link":"",to:"/edit"}}),e("van-cell",{attrs:{icon:"chat-o",title:"小智同学","is-link":"",to:"/chat"}}),e("van-cell",{attrs:{icon:"setting-o",title:"系统设置","is-link":""}}),e("van-cell",{attrs:{icon:"info-o",title:"退出登录","is-link":""},on:{click:t.esc}})],1)],1)])},it=[],at={name:"MyMine",data(){return{userinfo:{}}},methods:{esc(){this.$dialog.confirm({message:"是否要退出登录"}).then((()=>{this.$store.commit("user/Deltoken"),this.$store.commit("user/SetInfo",{}),localStorage.clear(),this.$router.push("/login")})).catch((()=>{}))}},async created(){console.log("create"),await this.$store.dispatch("user/requestInfo"),this.userinfo=this.$store.state.user.userInfo},destroyed(){console.log("销毁了")},activated(){console.log("缓存了")}},ot=at,rt=(0,l.Z)(ot,st,it,!1,null,"2e6a9dce",null),lt=rt.exports,ct=function(){var t=this,e=t._self._c;return e("div",[t._v(" 视频 ")])},ut=[],ht={name:"Myvideo"},dt=ht,ft=(0,l.Z)(dt,ct,ut,!1,null,null,null),vt=ft.exports,pt=function(){var t=this,e=t._self._c;return e("div",[t._v(" 问答 ")])},mt=[],_t={name:"MyAsk",data(){return{}}},yt=_t,gt=(0,l.Z)(yt,pt,mt,!1,null,null,null),kt=gt.exports,wt=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{title:"编辑资料"},scopedSlots:t._u([{key:"left",fn:function(){return[e("van-icon",{attrs:{name:"arrow-left",color:"#fff"},on:{click:t.back}})]},proxy:!0}])}),e("div",{staticClass:"image"},[e("van-image",{attrs:{round:"",fit:"cover",src:t.userInfo.photo}}),e("van-uploader",{attrs:{"after-read":t.afterRead,"image-fit":"cover"}})],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.corpshow,expression:"corpshow"}],staticClass:"corp"},[e("vueCropper",{ref:"cropper",attrs:{img:t.corpimg,autoCrop:"",autoCropWidth:"200",autoCropHeight:"200"}}),e("van-button",{staticClass:"esc",attrs:{type:"primary"},on:{click:function(e){t.corpshow=!1}}},[t._v("取消")]),e("van-button",{staticClass:"que",attrs:{type:"primary"},on:{click:t.doccrop}},[t._v("裁剪")])],1),e("div",[e("van-cell-group",[e("van-cell",{attrs:{title:"名称","is-link":"",value:t.userInfo.name},on:{click:t.nameMethods}}),e("van-cell",{attrs:{title:"性别","is-link":"",value:0===t.userInfo.gender?"男":"女"},on:{click:function(e){t.gender=!0}}}),e("van-cell",{attrs:{title:"生日","is-link":"",value:t.userInfo.birthday},on:{click:t.birthdayFun}})],1)],1),e("van-dialog",{attrs:{title:"修改昵称","show-cancel-button":""},on:{confirm:t.confirmName},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}},[e("van-cell-group",[e("van-field",{model:{value:t.nameinp,callback:function(e){t.nameinp=e},expression:"nameinp"}})],1)],1),e("van-popup",{attrs:{position:"bottom"},model:{value:t.gender,callback:function(e){t.gender=e},expression:"gender"}},[e("van-picker",{attrs:{title:"性别","show-toolbar":"",columns:t.columns},on:{confirm:t.onConfirm,cancel:function(e){t.gender=!1}}})],1),e("van-popup",{attrs:{position:"bottom"},model:{value:t.birthday,callback:function(e){t.birthday=e},expression:"birthday"}},[e("van-datetime-picker",{attrs:{type:"date",title:"选择年月日","min-date":t.minDate,"max-date":t.maxDate},on:{confirm:t.BirConfirm,cancel:function(e){t.birthday=!1}},model:{value:t.currentDate,callback:function(e){t.currentDate=e},expression:"currentDate"}})],1)],1)},bt=[],Ct=n(3825),Zt=n(5743),xt=n.n(Zt),$t={name:"MyEdit",components:{VueCropper:Ct.VueCropper},data(){return{info:{},name:!1,gender:!1,columns:["男","女"],birthday:!1,corpshow:!1,corpimg:"",nameinp:"",minDate:new Date(1949,9,1),maxDate:new Date,currentDate:new Date}},computed:{...(0,b.rn)("user",["userInfo"])},methods:{back(){window.history.back()},afterRead(t){this.corpimg=t.content,this.userInfo.photo=t.content,this.corpshow=!0},async onConfirm(t){await M({gender:"男"===t?0:1}),this.$store.commit("user/SetInfo",{...this.userInfo,gender:"男"===t?0:1}),this.gender=!1},doccrop(){this.$refs.cropper.getCropBlob((async t=>{const e=new FormData;e.append("photo",t);const n=await L(e);this.$store.commit("user/SetInfo",{...this.userInfo,photo:n.data.photo}),this.corpshow=!1}))},nameMethods(){this.name=!0,this.nameinp=this.userInfo.name},async confirmName(){if(""===this.nameinp)return this.$toast("不能喂为空");await M({name:this.nameinp}),this.$store.commit("user/SetInfo",{...this.userInfo,name:this.nameinp})},birthdayFun(){this.birthday=!0,this.currentDate=new Date(this.userInfo.birthday)},async BirConfirm(t){await M({birthday:xt()(t).format("YYYY-MM-DD")}),this.$store.commit("user/SetInfo",{...this.userInfo,birthday:xt()(t).format("YYYY-MM-DD")}),this.birthday=!1}},async created(){await this.$store.dispatch("user/requestInfo")}},St=$t,Pt=(0,l.Z)(St,wt,bt,!1,null,"7bebd00b",null),It=Pt.exports,Lt=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{placeholder:"",title:"搜索","left-arrow":""},on:{"click-left":function(e){return t.$router.push("/layout/home")}}}),e("van-search",{attrs:{"show-action":"",placeholder:"请输入搜索关键词"},on:{search:t.onSearch,input:t.onInput},scopedSlots:t._u([{key:"action",fn:function(){return[e("div",{on:{click:function(e){return t.onSearch(t.value)}}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t.value?e("van-cell-group",t._l(t.colorList,(function(n,s){return e("van-cell",{key:s,attrs:{icon:"search"},on:{click:function(e){return t.onSearch(t.list[s])}}},[e("div",{domProps:{innerHTML:t._s(n)}})])})),1):e("van-cell-group",[e("van-cell",{attrs:{title:"历史记录"}}),t._l(t.history,(function(n,s){return e("van-cell",{key:s,attrs:{title:n},on:{click:function(e){return t.onSearch(n)}}})}))],2)],1)},Mt=[];const Ot=t=>S({url:"/v1_0/suggestion",params:t}),qt=t=>S({url:"/v1_0/search",params:t});var Dt={name:"MySearch",data(){return{value:"",list:[],history:JSON.parse(localStorage.getItem("history-97"))||[]}},methods:{onSearch(t){if(""===t)return this.$toast("请输入搜索内容");-1!==this.history.indexOf(t)&&this.history.splice(this.history.indexOf(t),1),this.history.unshift(t),localStorage.setItem("history-97",JSON.stringify(this.history)),this.$router.push({name:"result",query:{key:t}})},async onInput(){if(""===this.value)return;const t=await Ot({q:this.value});t.data.options[0]?this.list=t.data.options:this.list=[]}},computed:{colorList(){return this.list.map((t=>t.replaceAll(this.value,`<span class="aaa">${this.value}</span>`)))}}},At=Dt,Et=(0,l.Z)(At,Lt,Mt,!1,null,"0feed1da",null),zt=Et.exports,Nt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"news"},[e("van-nav-bar",{attrs:{title:"文章详情",fixed:"",placeholder:""},scopedSlots:t._u([{key:"left",fn:function(){return[e("van-icon",{attrs:{name:"arrow-left",color:"#fff"},on:{click:function(e){return t.$router.back()}}})]},proxy:!0}])}),e("h2",{staticClass:"title"},[t._v(t._s(t.newsList.title))]),e("div",{staticClass:"autbox"},[e("van-image",{attrs:{round:"",fit:"cover",src:t.newsList.aut_photo}}),e("div",{staticClass:"infobox"},[e("span",[t._v(t._s(t.newsList.aut_name))]),e("span",{staticClass:"time"},[t._v(t._s(t.$format(t.newsList.pubdate)))])]),e("van-button",{directives:[{name:"show",rawName:"v-show",value:t.newsList.is_followed,expression:"newsList.is_followed"}],attrs:{size:"small",round:"",icon:"plus",type:"info"},on:{click:t.followings}},[t._v("关注")]),e("van-button",{directives:[{name:"show",rawName:"v-show",value:!t.newsList.is_followed,expression:"!newsList.is_followed"}],attrs:{size:"small",round:"",icon:"minus",type:"info"},on:{click:t.followings}},[t._v("取关")])],1),e("div",{staticClass:"content",domProps:{innerHTML:t._s(t.newsList.content)}}),e("div",{staticClass:"discussbox"},[e("my-discuss")],1)],1)},Tt=[],jt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"discuss"},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(n){return e("van-cell",{key:n.com_id},[e("div",{staticClass:"warp"},[e("van-image",{attrs:{round:"",fit:"cover",src:n.aut_photo}}),e("div",{staticClass:"center"},[e("div",{staticClass:"name"},[t._v(t._s(n.aut_name))]),e("div",{staticClass:"content"},[t._v(t._s(n.content))]),e("div",{staticClass:"time"},[e("span",[t._v(t._s(t.$format(n.pubdate)))]),e("van-button",{attrs:{type:"default",plain:"",size:"mini"},on:{click:function(e){return t.reply(n)}}},[t._v("回复("+t._s(n.reply_count)+")")])],1)]),e("van-icon",{directives:[{name:"show",rawName:"v-show",value:!n.is_liking,expression:"!item.is_liking "}],attrs:{name:"like-o"},on:{click:function(e){return t.lick(n)}}}),e("van-icon",{directives:[{name:"show",rawName:"v-show",value:n.is_liking,expression:"item.is_liking"}],attrs:{color:"#f00",name:"like"},on:{click:function(e){return t.lick(n)}}})],1)])})),1),e("div",{staticClass:"send"},[e("van-cell",{scopedSlots:t._u([{key:"default",fn:function(){return[e("van-cell-group",[e("van-field",{attrs:{placeholder:"请输入评论内容"},model:{value:t.inputval,callback:function(e){t.inputval=e},expression:"inputval"}})],1),e("van-button",{attrs:{type:"info",size:"small"},on:{click:t.send}},[t._v("发布")])]},proxy:!0}])})],1),e("van-action-sheet",{attrs:{title:"发表评论"},model:{value:t.replyShow,callback:function(e){t.replyShow=e},expression:"replyShow"}},[t.replyShow?e("MyActive",{attrs:{item:t.activeId},on:{add:function(e){t.activeId.reply_count++}}}):t._e()],1)],1)},Ht=[];const Yt=t=>S({url:"/v1_0/comments",params:t}),Bt=t=>S({url:"/v1_0/comments",method:"POST",data:t});var Jt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"discuss"},[e("van-cell",[e("div",{staticClass:"warp"},[e("van-image",{attrs:{round:"",fit:"cover",src:t.item.aut_photo}}),e("div",{staticClass:"center"},[e("div",{staticClass:"name"},[t._v(t._s(t.item.aut_name))]),e("div",{staticClass:"content"},[t._v(t._s(t.item.content))]),e("div",{staticClass:"time"},[e("span",[t._v(t._s(t.$format(t.item.pubdate)))])])])],1)]),t._m(0),e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(n){return e("van-cell",{key:n.com_id},[e("div",{staticClass:"warp"},[e("van-image",{attrs:{round:"",fit:"cover",src:n.aut_photo}}),e("div",{staticClass:"center"},[e("div",{staticClass:"name"},[t._v(t._s(n.aut_name))]),e("div",{staticClass:"content"},[t._v(t._s(n.content))]),e("div",{staticClass:"time"},[e("span",[t._v(t._s(t.$format(n.pubdate)))])])])],1)])})),1),e("div",{staticClass:"send"},[e("van-cell",{scopedSlots:t._u([{key:"default",fn:function(){return[e("van-cell-group",[e("van-field",{attrs:{placeholder:"请输入评论内容"},model:{value:t.inputval,callback:function(e){t.inputval=e},expression:"inputval"}})],1),e("van-button",{attrs:{type:"info",size:"small"},on:{click:t.send}},[t._v("发布")])]},proxy:!0}])})],1)],1)},Rt=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"list"},[e("span",[t._v("回复列表")])])}],Ft={name:"MyActive",data(){return{list:[],loading:!1,finished:!1,offset:null,inputval:""}},props:{item:{type:Object,required:!0}},methods:{async onLoad(){const t=await Yt({type:"c",source:this.item.com_id});this.list=t.data.results,this.loading=!1,this.list.length>=t.data.total_count&&(this.finished=!0)},async send(){if(""===this.inputval)return this.$toast("评论内容不能为空");const t=await Bt({target:this.item.com_id,content:this.inputval,art_id:this.$route.query.id});this.$emit("add"),this.list.unshift(t.data.new_obj),this.inputval=""}}},Vt=Ft,Ut=(0,l.Z)(Vt,Jt,Rt,!1,null,"5ca99b74",null),Wt=Ut.exports,Gt={components:{MyActive:Wt},data(){return{list:[],loading:!1,finished:!1,replyShow:!1,inputval:"",offset:null,activeId:{}}},props:{},methods:{async send(){if(""===this.inputval)return this.$toast("评论内容不能为空");const t=await Bt({target:this.$route.query.id,content:this.inputval});console.log(t),this.list.unshift(t.data.new_obj),this.inputval=""},async onLoad(){const t=await Yt({type:"a",source:this.$route.query.id,offset:this.offset});this.offset=t.data.last_id,this.list.push(...t.data.results),this.loading=!1,this.list.length>=t.data.total_count&&(this.finished=!0)},reply(t){this.activeId=t,this.replyShow=!0},async lick(t){t.is_liking?await U(t.com_id):await V({target:t.com_id}),t.is_liking=!t.is_liking}}},Kt=Gt,Qt=(0,l.Z)(Kt,jt,Ht,!1,null,"45a75bad",null),Xt=Qt.exports,te={name:"MyNews",components:{MyDiscuss:Xt},data(){return{newsList:{},value:"",replyId:null}},methods:{async followings(){this.newsList.is_followed?(await q(this.newsList.aut_id),this.$toast.success("关注成功")):(await O({target:this.newsList.aut_id}),this.$toast.fail("取消关注")),this.newsList.is_followed=!this.newsList.is_followed}},async created(){const t=await F(this.$route.query.id);this.newsList=t.data}},ee=te,ne=(0,l.Z)(ee,Nt,Tt,!1,null,"41ae56b7",null),se=ne.exports,ie=function(){var t=this,e=t._self._c;return e("div",[e("van-nav-bar",{attrs:{placeholder:"","left-arrow":"",title:`${t.$route.query.key}的搜索结果`},on:{"click-left":function(e){return t.$router.back()}}}),e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.list,(function(t){return e("van-cell",{key:t.art_id,attrs:{title:t.title,to:`/news/?id=${t.art_id}`}})})),1)],1)},ae=[],oe={data(){return{list:[],loading:!1,finished:!1,page:1}},methods:{async onLoad(){const t=await qt({q:this.$route.query.key,page:this.page});this.page++,this.list.push(...t.data.results),this.loading=!1,this.list.length>=t.data.total_count&&(this.finished=!0)}}},re=oe,le=(0,l.Z)(re,ie,ae,!1,null,"3a9bf304",null),ce=le.exports,ue=function(){var t=this,e=t._self._c;return e("div",{staticClass:"container"},[e("van-nav-bar",{attrs:{fixed:"","left-arrow":"",title:"小智同学"},on:{"click-left":function(e){return t.$router.back()}}}),e("div",{ref:"list",staticClass:"chat-list"},t._l(t.list,(function(n,s){return e("div",{key:s},[n.isme?e("div",{staticClass:"chat-item right"},[e("div",{staticClass:"chat-pao my"},[t._v(t._s(n.msg))]),e("van-image",{attrs:{fit:"cover",round:"",src:t.$store.state.user.userInfo.photo}})],1):e("div",{staticClass:"chat-item left"},[e("van-image",{attrs:{fit:"cover",round:"",src:"https://img.yzcdn.cn/vant/cat.jpeg"}}),e("div",{staticClass:"chat-pao"},[t._v(t._s(n.msg))])],1)])})),0),e("div",{staticClass:"reply-container van-hairline--top"},[e("van-field",{attrs:{placeholder:"说点什么..."},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.send.apply(null,arguments)}},model:{value:t.val,callback:function(e){t.val=e},expression:"val"}},[e("span",{staticStyle:{"font-size":"12px",color:"#999"},attrs:{slot:"button"},on:{click:t.send},slot:"button"},[t._v(" 提交 ")])])],1)],1)},he=[],de=n(2066),fe={data(){return{socket:null,val:"",list:[]}},methods:{send(){if(""===this.val)return this.$toast("请输入内容");this.socket.emit("message",{msg:this.val,timestamp:Date.now()}),this.list.push({msg:this.val,isme:!0}),this.val="",this.$nextTick((()=>{this.$refs.list.scrollTop=this.$refs.list.scrollHeight}))}},created(){this.$store.dispatch("user/requestInfo"),this.socket=(0,de.ZP)("http://toutiao.itheima.net",{query:{token:this.$store.state.user.token.token},transports:["websocket"]}),this.socket.on("message",(t=>{this.list.push(t)})),this.$nextTick((()=>{this.$refs.list.scrollTop=this.$refs.list.scrollHeight}))}},ve=fe,pe=(0,l.Z)(ve,ue,he,!1,null,"0273198a",null),me=pe.exports;s.ZP.use(d.ZP);const _e=d.ZP.prototype.push;d.ZP.prototype.push=function(t,e,n){return e||n?_e.call(this,t,e,n):_e.call(this,t).catch((t=>t))};const ye=[{path:"/",redirect:"/layout/home"},{path:"/layout",name:"layout",component:y,children:[{path:"home",name:"home",component:nt},{path:"ask",name:"ask",component:kt},{path:"video",name:"video",component:vt},{path:"mine",name:"mine",component:lt,meta:{needlogin:!0}}]},{path:"/login",name:"login",component:z},{path:"/edit",name:"edit",component:It},{path:"/news",name:"news",component:se},{path:"/chat",name:"chat",component:me},{path:"/search",name:"search",component:zt},{path:"/result",name:"result",component:ce}],ge=new d.ZP({routes:ye});ge.beforeEach(((t,e,n)=>{t.meta.needlogin?x.state.user.token.token?n():((0,h.Z)("请先登录"),n({name:"login",query:{back:t.path}})):n()}));var ke=ge,we=(n(3434),n(836),n(6811)),be=(n(2443),n(9864)),Ce=(n(7322),n(6631)),Ze=(n(446),n(8186)),xe=(n(2763),n(5094)),$e=(n(6735),n(4319)),Se=(n(6280),n(219)),Pe=(n(3429),n(7722)),Ie=(n(6386),n(5951)),Le=(n(109),n(4093)),Me=(n(9031),n(6790)),Oe=(n(4399),n(5947)),qe=(n(7944),n(5650)),De=(n(5825),n(9858)),Ae=(n(7938),n(2628)),Ee=(n(319),n(3481)),ze=(n(3089),n(4398)),Ne=(n(8984),n(797)),Te=(n(7505),n(7061)),je=(n(1049),n(140)),He=(n(6791),n(4269)),Ye=(n(4408),n(4639)),Be=(n(4889),n(5705)),Je=(n(6562),n(4159)),Re=(n(4825),n(7165)),Fe=(n(6871),n(1765));s.ZP.use(Fe.Z),s.ZP.use(Re.Z),s.ZP.use(Je.Z),s.ZP.use(Be.Z),s.ZP.use(Ye.Z),s.ZP.use(He.Z),s.ZP.use(je.Z),s.ZP.use(Te.Z),s.ZP.use(Ne.Z),s.ZP.use(ze.Z),s.ZP.use(h.Z),s.ZP.use(Ee.Z),s.ZP.use(Ae.Z),s.ZP.use(De.Z),s.ZP.use(qe.Z),s.ZP.use(Oe.Z),s.ZP.use(Me.Z),s.ZP.use(Le.Z),s.ZP.use(Ie.Z),s.ZP.use(Pe.Z),s.ZP.use(Se.Z),s.ZP.use($e.Z),s.ZP.use(xe.Z),s.ZP.use(Ze.Z),s.ZP.use(Ce.Z),s.ZP.use(be.Z),s.ZP.use(we.Z);var Ve=n(893),Ue=n.n(Ve);n(8212);xt().locale("zh-cn"),s.ZP.prototype.$format=t=>xt()(t).fromNow(),s.ZP.config.productionTip=!1,xt().extend(Ue()),new s.ZP({router:ke,store:x,render:t=>t(u)}).$mount("#app")}},e={};function n(s){var i=e[s];if(void 0!==i)return i.exports;var a=e[s]={exports:{}};return t[s].call(a.exports,a,a.exports,n),a.exports}n.m=t,function(){var t=[];n.O=function(e,s,i,a){if(!s){var o=1/0;for(u=0;u<t.length;u++){s=t[u][0],i=t[u][1],a=t[u][2];for(var r=!0,l=0;l<s.length;l++)(!1&a||o>=a)&&Object.keys(n.O).every((function(t){return n.O[t](s[l])}))?s.splice(l--,1):(r=!1,a<o&&(o=a));if(r){t.splice(u--,1);var c=i();void 0!==c&&(e=c)}}return e}a=a||0;for(var u=t.length;u>0&&t[u-1][2]>a;u--)t[u]=t[u-1];t[u]=[s,i,a]}}(),function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var s in e)n.o(e,s)&&!n.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){n.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){var t={143:0};n.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,a,o=s[0],r=s[1],l=s[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(i in r)n.o(r,i)&&(n.m[i]=r[i]);if(l)var u=l(n)}for(e&&e(s);c<o.length;c++)a=o[c],n.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return n.O(u)},s=self["webpackChunkhmtoutiao"]=self["webpackChunkhmtoutiao"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=n.O(void 0,[998],(function(){return n(668)}));s=n.O(s)})();